![计算机网络体系结构](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/计算机网络体系结构.png)

> 每层的传输信息的格式：标头(head) + 数据(data)

1. 物理层：物理世界的信息传送，上层无需考虑信息是怎么传输过去的

2. 数据链路层：为传输的比特定义含义/确定0和1的分组方法

   + 以太网占市场优势：MAC地址(物理世界的地址) + 局域网广播

     > 范围有限

3. 网络层：为解决局域网范围有限问题提出一个网络世界的虚拟地址——IP地址

   + IP协议占市场优势

4. 运输层：主机之上的应用程序，即端口之间的通信

   + UDP协议
   + TCP协议

5. > 以上都是对信息传输”分组“的限定，标头部分的含义也是这段信息性质的含义，但是数据部分仍未被定义

   应用层：对应用格式的说明——提供应用进程间的**逻辑通信**

# 概述绪论

+ Internet：因特网 == 互联网（外文引入时，前者是音译，后者更常用）

  > 互连网和互联网不一样：
  >
  > + internet（互连网）是一个通用名词，它泛指由多个计算机互连而成的计算机网络。网络之间的通信协议是可以任意选择。
  >
  > + Internet（互联网，或因特网）则是一个专有名词，它指当前全球最大的、开放的、由众多网络相互连接而成的特定互连网，它采用TCP/IP协议族作为通信的规则，且其前身是美国的ARPANET。
  
+ 21世纪是以网络为核心的信息时代：数字化、网络化和信息化。

  ​                    网络的种类                   ：电话线网络、有线电视网络和计算机网络。

+ **互联网特性：连通性和共享**。


## 术语及常识

+ 计算机网络（简称**网络**(network)）：由若干**结点**(node)和连接这些结点的**链路**(link)组成。

  结点          ：计算机、集线器、交换机或路由器等。

  局域网      ：用一朵云表示一个网络（云图）

  互连网	  ：网络之间通过路由器互连 -> 网络的网络。

  主机(host)：与网络相连的计算机 --> 用云表示的互连网里为路由器和链路。

  **网络把许多计算机连接在一起，而互连网则把许多网络通过路由器连接在一起。与网络相连的计算机常称为主机**

+ *信道*(channel)是指以传输媒体为基础的信号通路（包括有线或无线电线路），其作用是传输信号。

**基础结构的发展**：特点：演进逐渐、部分重叠。

1. 从APRANET向互连网发展的过程。

   APRANET是美国国防部创建的第一个分组互连网。只能就近相连

   其开始研究多种网络互连技术。

   1983年TCP/IP协议称为ARPANET上的标准协议，是的所以使用该协议的计算机都能在互连网上通信。互联网诞生。

2. 建成三级结构的互联网：主干网、地区网和校园网（或企业网）

   初衷是围绕大学的计算中心，后扩充到全世界。

3. 形成多层次的ISP结构的互联网

   美国政府资助的NSFNET逐渐被若干个商用的互联网主干网替代，政府不再负责互联网的运营

   + ISP：互联网服务提供者（商）

     申请到IP地址，开通通信线路。个体向ISP缴费、获得IP使用权，并用其接入互联网。

     + 不同层次：主干ISP、地区ISP和本地ISP
     + *IXP*：允许两个网络直接相连并交换分组——跨层相连

   万维网WWW（world Wide Web）方便非网络专业人员使用网络，广泛使用，也推动了互联网。

**互联网的标准化**：标准化工作的好坏对一种技术的发展有着很大的影响，太早不成熟，太晚太混乱。

​                               互联网标准的制定还具有面向大众的特点。

+ 分类：
  + **建议标准**RFC文档

    >  <img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/建议标准RFC文档的机构.png" style="zoom:80%;" />
    >
    > 互联网标准以RFC（请求评论）的形式在互联网上发表

  + **互联网标准**RFC文档

  + **实验的RFC文档**

+ 制定互联网的正式标准要经过的阶段：
  1. (互联网草案：有效期6个月，不是RFC文档)
  2. 建议标准：RFC文档
  3. 互联网标准：文档被分配编号。

# 计算机网络

## 组成

1. 边缘部分：由所有连接在互联网上的主机（端系统(endsystem)）组成

   用户直接使用，用来进行通信（传送数据、音频或视频）和资源分享

+ 通信的**本质**：主机A的某个进程和主机B上的另一个进程进行通信—简称—计算机之间的通信。

  + 客户-服务器方式（C/S方式）

    客户是服务请求方，服务器是服务提供方。

    + 客户(client)程序：

      发起通信、请求服务，客户程序必须知道服务器程序的地址

      不需要特殊的硬件和很复杂的操作系统

    + 服务器(server)程序：

      专门提供服务，可同时处理多个请求

      不断运行、被动接受

      需要强大的硬件和高级的操作系统指出。

    客户和服务器本指对应的计算机进程（软件）后也指机器。

  + 对等方式（P2P方式）

2. 核心部分：由大量**网络**和连接这些网络的**路由器**组成，为边缘部分提供服务的（提供连通性和交换）。

   **路由器**（router）：专用计算机（不是主机），实现**分组交换**的关键构件，其任务是存储转发收到的分组

+ 通信的方式：

  **交换**（swithching）：按照某种方式动态得分配传输线路得资源。

  > 资源：专有的物理通道，从主叫端到被叫端的一条连接。

  1. 电路交换：电话交换的方式：核心：电话交换机——为节省电话线建立的中转站

     + 电路交换过程：
       1. 建立连接
       2. 通话
       3. 释放连接

  2. **分组交换**：使用存储转发技术。

     + 把一个报文划分为几个分组后再进行传送。

       >  *报文*：发送的整块数据。

       >  *分组*（*包*(packet)）：报文划分成的更小的等长数组与必要的控制信息组成的*首部*(header)。

       主机发送包后，接受的路由器暂时存储下来，检查其首部，查找转发表，找到合适的接口发出去，把包交给下一个路由器。

     + 优点：

       | 优点 | 所采用的手段                                                 | 说明                     |
       | ---- | ------------------------------------------------------------ | ------------------------ |
       | 高效 | 在分组传输的过程中动态分配传输带宽，对通信链路是逐段占用     | 包-存储-发送             |
       | 灵活 | 为每一个分组独立地选择最合适地转发路由                       |                          |
       | 迅速 | 以分组作为传送单位，可以不先建立连接就能向其他主机发送分组   |                          |
       | 可靠 | 保证可靠性地网络协议；分布式多路由地分组交换网，使网络有很好地生存性 | 核心部分采用网状拓扑结构 |

     + 问题：

       1. *时延*：各路由器存储转发时需要排队
       2. *开销*：各分组必须携带的控制信息；整个分组交换网还需要专门的管理和控制机制。

  3. 报文交换：近代电报的发送，同样使用存储转发原理，不过是整个报文进行传送。

  比较：

  ![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/三种交换的比较.png)

  | 电路交换                                     | 报文交换 | 分组交换                                                     |
  | -------------------------------------------- | -------- | ------------------------------------------------------------ |
  |                                              |          |                                                              |
  |                                              |          |                                                              |
  |                                              |          | 流水线技术：时延小；<br>切片处理：丢失损失小；<br>不能无限分，有首部的。 |
  | 传送大量数据，传送时间>>建立连接时间，效率高 |          |                                                              |

## 类别

1. 按照网络的作用范围进行分类：

   1. 广域网WAN（也叫远程网）                          ：跨国、高速大量
   2. 城域网MAN                                                     ：城市内，以太网技术
   3. 局域网LAN（包括校园网或企业网）            ：高速
   4. 个人区域网PAN（无线个人区域网WPAN）：个人工作区域

   > 多处理机系统：CPU之间的，不属于计算机网络。

2. 按照网络的使用者进行分类

   1. 公用网（也叫公众网）
   2. 专用网：单位内

3. 用来把用户接入到互联网的网络

   1. 接入网AN（又称本地接入网或居民接入网）

## 性能

+ 比特（bit）：二进制数字——信息量的单位（信息论）

  字节（byte）（符号B）：8个比特。

  | 符号       | 读作 | 通信       | 计算机科学 |
  | ---------- | ---- | ---------- | ---------- |
  |            |      | 单位：比特 | 单位：字节 |
  | k（kilo）  | 千   | $10^3$     | $2^{10}$   |
  | M（Mega）  | 兆   | $10^6$     | $2^{20}$   |
  | G（Giga）  | 吉   | $10^9$     | $2^{30}$   |
  | T（Tera）  | 太   | $10^{12}$  | $2^{40}$   |
  | P（Peta）  | 拍   | $10^{15}$  | $2^{50}$   |
  | E（Exa）   | 艾   | $10^{18}$  | $2^{60}$   |
  | Z（Zetta） | 泽   | $10^{31}$  | $2^{70}$   |
  | Y（Yotta） | 尧   | $10^{24}$  | $2^{80}$   |

  + 通信领域k小写其余大写

  + K即可1000又可1024

+ 性能指标

1. 速率（数据率(date rate)、比特率(bit rate)）：数据的传送速率

   单位：$bit/s$（比特每秒）（或$b/s$，有时也写为$bps$，即bit per second）

   > 提到网络的速率时，往往指的是额定速率或标称速率，而非网络实际运行速率。

2. 带宽：

   1. （频域）某个信号具有的频带宽度。

      单位：赫兹（千赫、兆赫、吉赫等）

      > 过去主干线路传送的时模拟电路，于是，某信道允许通过的信号频带范围就称为该信道的带宽（或通频带）

   2. （时域）网络中某通道传送数据的能力，在单位时间内网络中的某个信道所能通过的“最高数据率”。

      单位与数据率一样。

3. 吞吐量：表示在单位时间内通过某个网络（或信道、接口）的实际数据量。

   ​				单位同数据率。

4. 时延(delay或latency)（延迟或迟延）：指数据（一个报文或分组，甚至比特）从网络（或链路）的一段传送到另一端所需的时间。

   1. 发送时延(transmisson delay)（传输时延）：是主机或路由器发送数据帧所需要的时间

      $发送时延 = \frac{数据帧长度(bit)}{发送速率(bit/s)}$ 一个数据帧从发送到结束的时间。

   2. 传播时延(propagation delay)：是电磁波在信道中传播一定的距离所需要花费的时间

      $传播时延 = \frac{信道长度(m)}{电磁波在信道上的传播速率(m/s)}$ 在信道中的时间

      > 这个时延是只与长度有关的，信道中的速率只与介质有关，我们说的提高通信速率基本是提高发送时延。
      >
      > 空气：$3.0 * 10^5 km/s$
      >
      > 铜线：$2.3 * 10^5 km/s$
      >
      > 光纤：$2.0 * 10^5 km/s$

   3. 处理时延：主机或路由器在收到分组时要花费一定的时间进行处理。

   4. 排队时延：在网络运输时要经过许多路由器，分组进入路由器后要在输出队列排队等待处理；确定接口后，也要在输出队列排队等待转发。

      取决于网络当前的通信量；当通信量很大发生队列溢出，分组丢失，相当于排队时延无穷大。
      

   <img src="https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/时延.png" style="zoom:80%;" />

   实际时延是以上四类时延之和。

   $总时延 = 发送时延 + 传播时延 + 处理时延 + 排队时延$

5. 时延带宽积（以比特为单位的链路长度）：传播时延和带宽的乘积（传播时延至于链路长度有关，带宽则是信道的抽象宽度，这是乘积就是抽象的单位时间可过的体积所容纳的比特数，而）

   $时延带宽积 = 传播时延(s) * 带宽(bit/s)$ 

6. 往返时间RTT：发送方从发送到确定对方收到的时间

7. 利用率

   1. 信道利用率：某信道有百分之几的时间是被利用的（有数据通过）
   2. 网络利用率：全网络的信道利用率的加权平均值

   $网络当前的时延 = \frac{网络空闲时的时延}{1 - 利用率}$ 当利用率到1/2后，时延会急剧增大，所以较大主干网ISP通常控制信道利用率不超过50%。超过就要准备扩容、增大线路的带宽。

   信道或网络的利用率过高会产生非常大的时延。

+ 非性能特征：
  1. 费用
  2. 质量
  3. 标准化
  4. 可靠性
  5. 可拓展性和可升级性
  6. 易于管理和维护

## 体系结构

1. 硬件基础

2. 通信协议——相互“协调”***分层***

   1. 发起通信的及其将信道进行*激活*(activate)
   2. 告知网络如何识别对方
   3. 确定对方是否正常
   4. 确定对方准备好（文件格式兼容）（如果不兼容其中一个完成格式转换）
   5. 如何处理事故

   + 各层之间是独立的：仅需要知道接口
   + 灵活性好：更新每一层只需要保证接口不变
   + 结构上可分割开
   + 易于实现和维护：分块
   + 能促进标准化工作
     + 差错控制
     + 流量控制
     + 分段和重装
     + 复用和分用
     + 连接建立和释放

> 1. 各大公司建立自己的网络标准
>
>    ege：1974，IBM宣布**系统网络体系结构SNA**网络标准
>
>    公司内部设备可以连网，不同公司难以连通，具有垄断市场的属性。
>
>    急需同一的标准。
>
> 2. 1977，国际化标准化组织ISO提出标准框架**开放系统互连基本参考模型OSI/RM**简称**OSI**
>
>    1983，形成正式文件，即**ISO 7498**国际标准。（==七层==协议的体系结构）
>
>    开放即非独家垄断
>
> 3. TCP/IP（==四层==）协议已经占领市场（事实上的国际标准）

+ 网络协议(network protocol)（简称协议）：为进行网络中的数据交换而建立的规则、标准或约定。（协议的三个组成要素）

  > 为在计网中交换数据，需遵循实现约定好的规则，这些规则明确规定了所交换的数据格式以及有关的同步问题。
  >
  > 同步：不是狭义的同频同相，而是广义的同步含有时序的意思。

  + 语法，即数据与控制信息的结构或格式；
  + 语义，即需要发出何种控制信息，完成何种动作以及做出何种响应；
  + 同步，即时间实现顺序的详细说明

+ **计算机网络的各层及其协议的集合**就是网络的*体系结构*(architecture)，即计算机网络的体系结构就是这个计算机网络及其构建所应完成的功能的精确定义[GREE82]，这些功能使用何种硬件和软件实现，要遵循这种体系结构的实现(implementation)。

  体系结构是抽象的，而实现则是具体的，是真正在运行的计算机硬件和软件

+ ISO      ：7层

  TCP/IP：4层  不止TCP/IP协议，而以其代称——TCP/IP协议族(protocol suite)

  课本    ：5层

   ![计算机网络体系结构](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/计算机网络体系结构.png)

  + 应用层(application layer)：

    + 定义：应用进程间通信和交互的规则
    + 任务：通过应用进程间的交互来完成特定网络应用

    > 进程：指主机中正在运行的程序
    >
    > 报文(message)：应用层交互的数据单元

    + ege：域名系统DNS、万维网HTTP、电子邮件SMTP

  + 运输层(transport layer)/传输层（如果使用transmission的话）

    + 任务：负责向两台主机中进程之间的通信提供通用的数据传输服务
    + 分类：
      1. 传输控制协议TCP(Transmiooson Control Protoecol)：提供面向连接的、可靠的数据传输服务，其数据传输的单位是报文段(segment)
      2. 用户数据报协议UDP(User Datagram Protocol)：提供无连接的*尽最大努力*(bset-effort)的数据传输服务（不保证数据传输的可靠性），其数据传输的单位是用户数据报

  + 网络层(network layer)

    + 任务：为分局交换网上的不同主机提供通信服务

      > 发送数据时，网络层把运输层产生的报文段或用户数据报封装成分组或包进行传送。**网络层使用IP协议**，因此将**分组**也叫**IP数据报**（简称数据报）

    > 互联网由大量的*异构*(heterogeneous)网络通过路由器(router)互相连接起来的，互联网使用的网络协议是无连接的*网际协议IP*(Interner Protocol)和许多路由选择协议。因此互联网的网络层也叫网际层或IP层

  + 数据链路层(data link layer)（简称链路层）

    + 任务：在链路上将网络层交下来的IP数据报**组装成帧**(framing)，在两个相邻节点间的链路上传送*帧*(frame)。每一帧包括数据和必要的控制信息（如同步信息、地址信息、差错控制）

      如果发现差错，链路层会丢弃这个帧，以免浪费网络资源

  + 物理层(physical layer)：

    + 任务：传比特（电压范围，如何识别）

      > 对比特的解释是物理媒体（也被称为第0层）的任务。

   ![数据在各层之间的传递过程](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/数据在各层之间的传递过程.png)

  + 术语：
    + 协议数据单元PDU(Protocol Data Unit)：OSI参考模型把对等层次之间传送的数据单位的称呼，并被其他标准采用
    + 对等层(peer layers)：
    + 协议栈(protocol stack)

+ 实体、协议、服务和服务访问点

  + 实体(entity)：表示任何可以发送或接收信息的硬件或软件进程
  + 协议(protocol)：控制两个对等实体（或多个实体）进行通信的规则的集合

  在协议的控制下，两个对等实体间的通信使得本层能够向上一层提供服务。要实现本层协议，还需要使用下一层所提供的服务

  + 服务：接口——服务原语

  协议的实现保证能够向上一层提供服务，使用本层服务的实体只能看见服务而无法看见下面的协议——下面的协议对上面的实体是==透明==的——**协议是水平的、服务是垂直的**

  + 服务访问点SAP(Service Access Point)：同一系统相邻实体进行交互的地方。本质是逻辑接口

    服务用户：下层实体相当于为上层实体的服务提供者，它的上边

+ 协议对异常情况的处理

+ TCP/IP的体系结构：可以为各式各样的应用提供服务（everything over IP），允许IP协议在各式各样的网络构成的互联网运行（IP over everything）

  ![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Computer-Network/TCPIP协议族.png)
