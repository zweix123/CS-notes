数据库设计(database design)：数据库设计是指对于一个给定的应用环境，构造（设计）优化的数据库逻辑模式和物理结构，并据此建立数据库及其应用系统，使之能够有效地存储和管理数据，满足各种用户地应用需求，包括信息管理要求和数据操作要求。

# 概述

+ 数据库设计(database design)定义：
  + 广义：是数据库及其应用系统的设计
  + 狭义：设计数据库本身
  + 一般定义：指对一个给定的应用环境，构造（设计）优化的数据库逻辑模式和物理结构，并据此建立数据库及其应用系统，使之能够有效地存储和管理数据，满足各种用户地应用需求，包括信息管理要求和数据操作要求。
    + 信息管理要求：数据库中应存储和管理那些数据对象
    + 数据操作要求：对数据对象要进行哪些操作（增删改查统计）
+ 特点：
  1. 数据库建设地基本规律：“三分技术，七分管理，十二分基础数据”
  2. 结构（数据）设计和行为（处理）设计相结合
+ 方法
  + 新奥尔良(New Oleans)方法
  + 基于E-R模型的设计方法
  + 3NF（第三范式）的设计方法
  + 面向对象的数据库设计方法
  + 统一建模语言(Unified Model Language, UML)方法

# 步骤

![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Database-System/数据库设计步骤.png) ![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Database-System/数据库设计步骤2.png)

+ ![](https://cdn.jsdelivr.net/gh/zweix123/CS-notes@master/source/Database-System/数据库设计阶段与模式对应.png)

## 需求分析

### 任务与方法

### 数据字典

+ 数据字典定义：关于数据库中数据的描述，即**元数据**，而不是数据本身。

  ​               数据字典是在需求分析阶段建立，在数据库设计过程中不断修改、充实、完善的。

+ 数据字典包括：

  + 数据项
  + 数据结构
  + 数据流
  + 数据存储
  + 处理过程

-----

+ 数据项：不可再分的数据单位
  + 描述：数据项名，数据项含义说明，别名，数据类型，长度，取值范围，取值含义，与其他数据项的逻辑关系，数据项之间的关系
    + 数据完整性约束条件：取值范围、与其他数据项的逻辑关系
+ 数据结构：数据之间的组合关系
  + 描述：数据结构名，含义说明，组成:{数据项或数据结构}
+ 数据流：数据结构在系统内传输的路径
  + 描述：数据流名，说明，数据流来源，数据流去向，组成:{数据结构}，平均流量，高峰期流量
+ 数据存储：数据结构停留或保存的地方。数据流的来源和去向
  + 描述：数据存储名，说明，编号，输入的数据流（来源），输出的数据流（去向），组成:{数据结构}，数据量，存取频度，存取方式
    + 存储频度：每小时、每天或每周存取次数及每次存取的数据量
    + 存取方式：批处理还是联机处理、检索还是更新、顺序检索还是随机检索
+ 处理过程：
  + 描述：处理过程名，说明，输入:{数据流}，输出:{数据流}，处理:{简要说明}

## 概念结构设计

+ 概念模型：
  + 定义：将需求分析得到的用户需求抽象为信息结构
  + 特点：
    1. 能真实、充分地反映现实世界
    2. 易于理解
    3. 易于更改
    4. 易于向关系、网状、层次等各种数据模型转换

### E-R模型

> P.P.S.Chen提出的E-R模型是用E-R图来描述现实世界的概念模型

1. 实体

   + 实体集
   + 实体型

2. 属性

3. 实体之间的联系

   + 两个实体型之间的联系
     1. 一对一联系（1：1）：如果对于实体集A中的每一个实体，实体集B中至多有一个实体与之联系，反之亦然
     2. 一对多联系（1：n）：如果对于实体集A中的每一个实体，实体集B中的n个实体（n >= 0）与指联系，反之，对于实体集B中的每一个实体，实体集A中至多只有一个实体与之联系
     3. 多对多联系（m：n）：如果对于实体集A中的每一个实体，实体集B中有n个实体（n >= 0）与之联系，反之，对于实体集B中的每一个实体，实体集A中也有m个实体（m >= 0）与之联系
   + 两个以上的实体型之间的联系：一对一、一对多、多对多
   + 单个实体型内的联系：一对一、一对多、多对多

   把参与联系的实体性的数目称为联系的度，对应的称之为N元联系

-----

+ E-R图提供了表示实体型、属性和联系的方法
  1. 实体型用矩形表示，矩形框内写实体名
  2. 属性用椭圆形表示，并用无向边将其与相应的实体型连接起来
  3. 联系用菱形表示，菱形框内写明联系名，并用无向边分别与有关实体型连接起来，同时在无向边旁标记上联系的类型（$1:1、1:n、m:m$）

+ 扩展的E-R模型

  1. ISA(is a)联系：子类继承了父类的所有属性：三角

     1. 分类属性：普通继承：三角

     2. 不相交约束与可重叠约束：只能继承一个：三角内有叉

     3. 完备性约束：父类中的一个实体是否必须是某一个子类中的实体

        ​                       是：完全特化(total specialization)：双线连接

        ​                       否：部分特化(partial specialization)：单线连接

  2. 基数约束：对实体之间一对一、一对多和多对多联系的细化

     + 格式：一个数对$min..max$，$0 \le min \le max$；$*$表示无穷大

     + $min=1$：强制参与约束：被施加基数约束的实体型中的每个实体都要参与联系

       $max = 0$：非强制参与约束：被施加基数约束的实体型中的实体可以出现在联系中，也可以不出现

  3. Part-of联系：部分联系：实体型是另一个实体型的一部分

     1. 非独占的Part-of联系：整体和部分可以单独存在——非强制参数约束
     2. 独占联系：部分不能脱离整体存在
        + 弱实体类型：该实体型的存在依赖于其他实体型的存在：双矩形表示
        + 强实体类型：该实体型的存在不依赖于其他实体型的存在
        + 识别联系：独占联系：双菱形表示

### 概念结构设计

1. 实体与属性的划分原则

   + 原则：为简化E-R图的处置，现实世界的事务能作为属性对待的尽量作为属性对待

   1. 作为属性，不能再具有描述的性质，即属性必须是不可分的数据项，不包含其他属性
   2. 属性不能与其他实体具有联系

2. E-R图的集成

   1. 合并：解决各分E-R图之前的冲突，将分E-R图合并起来生成初步E-R图
      + 冲突的种类：
        1. 属性冲突：
           1. 属性域冲突
           2. 属性取值单位冲突
        2. 命名冲突
           1. 同名异义：不同意义的对象在不同的局部应用中具有相同的名字
           2. 异名同义：同一意义的对象在不同的局部应用中具有不同的名字
        3. 结构冲突
           1. 同一对象在不同应用中具有不同的抽象
           2. 同一实体在不同子系统的E-R图中所包含的属性个数和属性排列次序不完全相同
           3. 实体间的联系在不同的E-R图中为不同的类型
   2. 修改和重构：消除不必要的冗余，生成基本E-R图

## 逻辑结构设计

> 把E-R图转换为合适的数据模型

### 关系模型

### 优化

### 其他

+ 设计用户子模式

## 物理结构设计

+ 为一个给定的逻辑数据模型选取一个最适合应用要求的物理结构的过程
+ 步骤：
  1. 确定数据库的物理结构：存取方法和存储结构
     + 为关系模式选择存取方法
       1. 索引方法
       2. 聚簇(clustering)方法
     + 设计关系、索引的数据库文件的物理存储结构
  2. 对物理结构进行评价：时间和空间效率
+ 存取方法：
  + B+树
  + hash索引

## 数据库实施维护

