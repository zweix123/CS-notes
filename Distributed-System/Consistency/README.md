>数据库领域也有一致性Consistency的概念，但它的一致性是ACID（原子性、一致性、隔离性和持久性）中的。两者不同。

分布式系统的一致性问题最终都归结为分布式存储的一致性问题。
而几乎所有的分布式存储都使用某种**冗余**的方式。
而冗余的基础就是**多副本**策略。
而副本之间的一致性就需要一致性算法保证。

# 简单的复制策略
+ client客户端
+ master主
+ slave从

## 主从异步复制

1. master接到写请求
2. master写入本磁盘
3. master应答
4. master复制数据到slaves

问题可能出现在3和4之间。
可靠性不足

## 主从同步复制

1. master接到写请求
2. master复制数据到slaves
3. slave阻塞
4. client等待应答，直到所有slaves返回

可靠性得到保证，但是可用性不足，比如某个从宕机则写不下去了。

## 半同步复制

1. master接到写请求
2. master复制数据到slave
3. slave可能阻塞
4. 如果**足够多**的slave返回，则返回客户端

此时可靠性和可用性都得到了保证，但是一致性出现问题。比如数据a到1没到2，数据b到2没到1，此时主宕机需要恢复数据则任何一个slave都不能提供完整数据

## 多数派

机器对等，每个数据必须写入**半数以上**的机器，每次读取必须检查半数以上的机器是否有。
可靠性足够，可用性对宕机容忍足够，任一机器故障也能读取问政数据。

>最多容忍$\frac{n - 1}{2}$个节点损坏

还有一个但是

比如在node-1, node-2写入`a = x`，在node-2, node-3写入`a = y`，此时如果读取node-1和node-2的数据，会发现不同的数据。
于是添加全局递增的**时间戳**，忽略更小的时间戳。即后写入优胜。

但是依然会有问题。比如依次写保证多数写入，然后再次写client挂掉，没有保证多数写，此时读的话如果正好是第一次写的多数，则第二次写的正确的数据被忽略。


## 从多数派到Paxos

